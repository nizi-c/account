# è®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

æ”¶æ”¯è®°è´¦APPæ˜¯ä¸€ä¸ªåŸºäºHarmonyOSçš„ç§»åŠ¨åº”ç”¨ï¼Œä½¿ç”¨ArkTSè¯­è¨€å¼€å‘ã€‚è¯¥åº”ç”¨é‡‡ç”¨MVVMæ¶æ„æ¨¡å¼ï¼Œé€šè¿‡å…³ç³»å‹æ•°æ®åº“è¿›è¡Œæ•°æ®æŒä¹…åŒ–ï¼Œæä¾›ç›´è§‚çš„ç”¨æˆ·ç•Œé¢ç”¨äºè®°å½•å’Œåˆ†æä¸ªäººæ”¶æ”¯æƒ…å†µã€‚åº”ç”¨æ”¯æŒæƒ…ç»ªè®°è´¦ã€æˆå°±ç³»ç»Ÿç­‰åˆ›æ–°åŠŸèƒ½ï¼Œå¹¶é€šè¿‡å“åº”å¼è®¾è®¡é€‚é…æ‰‹æœºå’Œå¹³æ¿è®¾å¤‡ã€‚

## æ¶æ„

### æ•´ä½“æ¶æ„

åº”ç”¨é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Presentation Layer          â”‚
â”‚    (Pages, Components, ViewModels)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Business Logic Layer        â”‚
â”‚    (Services, Managers, Utils)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Data Access Layer           â”‚
â”‚    (Repositories, Models, DAO)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Storage Layer               â”‚
â”‚    (RelationalStore, Preferences)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

- **UIæ¡†æ¶**: ArkUI (å£°æ˜å¼UI)
- **è¯­è¨€**: ArkTS (TypeScriptæ‰©å±•)
- **æ•°æ®åº“**: RelationalStore (å…³ç³»å‹æ•°æ®åº“)
- **çŠ¶æ€ç®¡ç†**: @State, @Prop, @Linkè£…é¥°å™¨
- **å›¾è¡¨åº“**: è‡ªå®šä¹‰Canvasç»˜åˆ¶æˆ–ç¬¬ä¸‰æ–¹å›¾è¡¨ç»„ä»¶
- **æœ¬åœ°å­˜å‚¨**: Preferences (ç”¨æˆ·åå¥½è®¾ç½®)

## ç»„ä»¶å’Œæ¥å£

### æ ¸å¿ƒç»„ä»¶

#### 1. æ•°æ®æ¨¡å‹å±‚

**Transaction (äº¤æ˜“è®°å½•æ¨¡å‹)**
```typescript
interface Transaction {
  id: number;                    // ä¸»é”®
  type: TransactionType;         // æ”¶å…¥/æ”¯å‡º
  amount: number;                // é‡‘é¢
  category: string;              // åˆ†ç±»
  description: string;           // ç”¨é€”æè¿°
  date: number;                  // æ—¶é—´æˆ³
  mood?: MoodType;               // æƒ…ç»ªæ ‡ç­¾ï¼ˆå¯é€‰ï¼‰
  createdAt: number;             // åˆ›å»ºæ—¶é—´
  updatedAt: number;             // æ›´æ–°æ—¶é—´
}

enum TransactionType {
  INCOME = 'income',
  EXPENSE = 'expense'
}

enum MoodType {
  SATISFIED = 'satisfied',      // ğŸ˜Šæ»¡æ„
  REGRET = 'regret',            // ğŸ˜Ÿåæ‚”
  SURPRISE = 'surprise'         // ğŸ‰æƒŠå–œ
}
```

**Category (åˆ†ç±»æ¨¡å‹)**
```typescript
interface Category {
  id: string;
  name: string;
  type: TransactionType;
  icon: string;                  // å›¾æ ‡èµ„æºè·¯å¾„
  color: string;                 // åˆ†ç±»é¢œè‰²
}
```

**Achievement (æˆå°±æ¨¡å‹)**
```typescript
interface Achievement {
  id: string;
  name: string;
  description: string;
  icon: string;
  unlocked: boolean;
  unlockedAt?: number;
  progress: number;              // 0-100
  target: number;
}
```

**Summary (æ±‡æ€»ç»Ÿè®¡æ¨¡å‹)**
```typescript
interface Summary {
  period: PeriodType;
  startDate: number;
  endDate: number;
  totalIncome: number;
  totalExpense: number;
  netAmount: number;
  categoryBreakdown: CategorySummary[];
}

interface CategorySummary {
  category: string;
  amount: number;
  percentage: number;
  count: number;
}

enum PeriodType {
  DAY = 'day',
  WEEK = 'week',
  MONTH = 'month',
  YEAR = 'year'
}
```

#### 2. æ•°æ®è®¿é—®å±‚

**TransactionRepository**
```typescript
class TransactionRepository {
  // åˆ›å»ºäº¤æ˜“è®°å½•
  async create(transaction: Omit<Transaction, 'id'>): Promise<Transaction>
  
  // åˆ é™¤äº¤æ˜“è®°å½•
  async delete(id: number): Promise<boolean>
  
  // æŸ¥è¯¢äº¤æ˜“è®°å½•
  async query(filter: TransactionFilter): Promise<Transaction[]>
  
  // è·å–æ‰€æœ‰äº¤æ˜“è®°å½•
  async getAll(): Promise<Transaction[]>
  
  // æŒ‰æ—¥æœŸèŒƒå›´æŸ¥è¯¢
  async getByDateRange(startDate: number, endDate: number): Promise<Transaction[]>
  
  // æŒ‰åˆ†ç±»æŸ¥è¯¢
  async getByCategory(category: string): Promise<Transaction[]>
}

interface TransactionFilter {
  type?: TransactionType;
  categories?: string[];
  minAmount?: number;
  maxAmount?: number;
  startDate?: number;
  endDate?: number;
  description?: string;
  mood?: MoodType;
}
```

**CategoryRepository**
```typescript
class CategoryRepository {
  // è·å–æ‰€æœ‰åˆ†ç±»
  async getAll(): Promise<Category[]>
  
  // æŒ‰ç±»å‹è·å–åˆ†ç±»
  async getByType(type: TransactionType): Promise<Category[]>
  
  // è·å–é¢„å®šä¹‰åˆ†ç±»
  getDefaultCategories(): Category[]
}
```

**AchievementRepository**
```typescript
class AchievementRepository {
  // è·å–æ‰€æœ‰æˆå°±
  async getAll(): Promise<Achievement[]>
  
  // æ›´æ–°æˆå°±çŠ¶æ€
  async updateAchievement(id: string, unlocked: boolean, progress: number): Promise<void>
  
  // è·å–å·²è§£é”æˆå°±
  async getUnlocked(): Promise<Achievement[]>
}
```

#### 3. ä¸šåŠ¡é€»è¾‘å±‚

**TransactionService**
```typescript
class TransactionService {
  // æ·»åŠ äº¤æ˜“
  async addTransaction(data: TransactionInput): Promise<Transaction>
  
  // åˆ é™¤äº¤æ˜“
  async deleteTransaction(id: number): Promise<void>
  
  // æŸ¥è¯¢äº¤æ˜“
  async searchTransactions(filter: TransactionFilter): Promise<Transaction[]>
  
  // è·å–æ—¥æ±‡æ€»
  async getDailySummary(date: number): Promise<Summary>
  
  // è·å–æœˆæ±‡æ€»
  async getMonthlySummary(year: number, month: number): Promise<Summary>
  
  // è·å–å‘¨æ±‡æ€»
  async getWeeklySummary(date: number): Promise<Summary>
  
  // è·å–å¹´æ±‡æ€»
  async getYearlySummary(year: number): Promise<Summary>
}
```

**AchievementService**
```typescript
class AchievementService {
  // æ£€æŸ¥å¹¶æ›´æ–°æˆå°±
  async checkAchievements(): Promise<Achievement[]>
  
  // æ£€æŸ¥è¿ç»­è®°è´¦æˆå°±
  async checkConsecutiveDays(): Promise<void>
  
  // æ£€æŸ¥é¢„ç®—æ§åˆ¶æˆå°±
  async checkBudgetControl(): Promise<void>
  
  // æ£€æŸ¥æ¶ˆè´¹åˆç†åŒ–æˆå°±
  async checkReasonableSpending(): Promise<void>
  
  // è·å–æˆå°±è¿›åº¦
  async getAchievementProgress(id: string): Promise<number>
}
```

**StatisticsService**
```typescript
class StatisticsService {
  // ç”Ÿæˆé¥¼å›¾æ•°æ®
  async generatePieChartData(period: PeriodType, date: number): Promise<ChartData>
  
  // ç”ŸæˆæŠ˜çº¿å›¾æ•°æ®
  async generateLineChartData(startDate: number, endDate: number): Promise<ChartData>
  
  // ç”Ÿæˆæƒ…ç»ªæ—¥å†æ•°æ®
  async generateMoodCalendar(year: number, month: number): Promise<MoodCalendarData>
  
  // è®¡ç®—åˆ†ç±»å æ¯”
  async calculateCategoryPercentage(period: PeriodType, date: number): Promise<CategorySummary[]>
}
```

#### 4. è¡¨ç°å±‚

**é¡µé¢ç»„ä»¶**

- **HomePage**: é¦–é¡µï¼Œæ˜¾ç¤ºå½“æ—¥æ”¶æ”¯æ¦‚è§ˆå’Œå¿«é€Ÿæ·»åŠ å…¥å£
- **AddTransactionPage**: æ·»åŠ äº¤æ˜“é¡µé¢ï¼ŒåŒ…å«è¡¨å•è¾“å…¥
- **TransactionListPage**: äº¤æ˜“åˆ—è¡¨é¡µé¢ï¼Œæ”¯æŒä¾§æ»‘åˆ é™¤
- **StatisticsPage**: ç»Ÿè®¡é¡µé¢ï¼Œæ˜¾ç¤ºå›¾è¡¨å’Œæ±‡æ€»æ•°æ®
- **QueryPage**: æŸ¥è¯¢é¡µé¢ï¼Œæä¾›é«˜çº§ç­›é€‰åŠŸèƒ½
- **MoodCalendarPage**: æƒ…ç»ªæ—¥å†é¡µé¢
- **AchievementPage**: æˆå°±é¡µé¢

**å¯å¤ç”¨ç»„ä»¶**

- **TransactionCard**: äº¤æ˜“è®°å½•å¡ç‰‡
- **CategorySelector**: åˆ†ç±»é€‰æ‹©å™¨
- **MoodSelector**: æƒ…ç»ªé€‰æ‹©å™¨
- **DateRangePicker**: æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨
- **PieChart**: é¥¼å›¾ç»„ä»¶
- **LineChart**: æŠ˜çº¿å›¾ç»„ä»¶
- **SummaryCard**: æ±‡æ€»å¡ç‰‡
- **AchievementBadge**: æˆå°±å¾½ç« 

## æ•°æ®æ¨¡å‹

### æ•°æ®åº“è®¾è®¡

**transactions è¡¨**
```sql
CREATE TABLE transactions (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  type TEXT NOT NULL,
  amount REAL NOT NULL,
  category TEXT NOT NULL,
  description TEXT,
  date INTEGER NOT NULL,
  mood TEXT,
  created_at INTEGER NOT NULL,
  updated_at INTEGER NOT NULL
)
```

**achievements è¡¨**
```sql
CREATE TABLE achievements (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  description TEXT,
  icon TEXT,
  unlocked INTEGER DEFAULT 0,
  unlocked_at INTEGER,
  progress REAL DEFAULT 0,
  target REAL NOT NULL
)
```

**categories è¡¨**
```sql
CREATE TABLE categories (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  type TEXT NOT NULL,
  icon TEXT,
  color TEXT
)
```

### æ•°æ®å…³ç³»

- Transaction ä¸ Category æ˜¯å¤šå¯¹ä¸€å…³ç³»ï¼ˆä¸€ä¸ªåˆ†ç±»å¯ä»¥æœ‰å¤šä¸ªäº¤æ˜“ï¼‰
- Transaction ä¸ MoodType æ˜¯å¯é€‰çš„ä¸€å¯¹ä¸€å…³ç³»
- Achievement ç‹¬ç«‹å­˜å‚¨ï¼Œé€šè¿‡ä¸šåŠ¡é€»è¾‘ä¸ Transaction å…³è”

## æ­£ç¡®æ€§å±æ€§

*å±æ€§æ˜¯ä¸€ä¸ªç‰¹å¾æˆ–è¡Œä¸ºï¼Œåº”è¯¥åœ¨ç³»ç»Ÿçš„æ‰€æœ‰æœ‰æ•ˆæ‰§è¡Œä¸­ä¿æŒä¸ºçœŸâ€”â€”æœ¬è´¨ä¸Šæ˜¯å…³äºç³»ç»Ÿåº”è¯¥åšä»€ä¹ˆçš„æ­£å¼å£°æ˜ã€‚å±æ€§ä½œä¸ºäººç±»å¯è¯»è§„èŒƒå’Œæœºå™¨å¯éªŒè¯æ­£ç¡®æ€§ä¿è¯ä¹‹é—´çš„æ¡¥æ¢ã€‚*


### å±æ€§åæ€

åœ¨ç¼–å†™å…·ä½“å±æ€§ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è¯†åˆ«å’Œæ¶ˆé™¤å†—ä½™ï¼š

**è¯†åˆ«çš„å†—ä½™ï¼š**
- å±æ€§ 3.1ï¼ˆå½“æ—¥äº¤æ˜“è¿‡æ»¤ï¼‰å’Œ 3.3ï¼ˆå½“æœˆäº¤æ˜“è¿‡æ»¤ï¼‰å¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªé€šç”¨çš„æ—¥æœŸèŒƒå›´è¿‡æ»¤å±æ€§
- å±æ€§ 3.2ï¼ˆå½“æ—¥æ±‡æ€»ï¼‰ã€3.4ï¼ˆå½“æœˆæ±‡æ€»ï¼‰ã€4.1ï¼ˆå‘¨æ±‡æ€»ï¼‰ã€4.2ï¼ˆæœˆæ±‡æ€»ï¼‰ã€4.3ï¼ˆå¹´æ±‡æ€»ï¼‰éƒ½æ˜¯æ±‡æ€»è®¡ç®—ï¼Œå¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªé€šç”¨çš„æ±‡æ€»æ­£ç¡®æ€§å±æ€§
- å±æ€§ 2.2ï¼ˆæ”¶å…¥åˆ†ç±»è¿‡æ»¤ï¼‰å’Œ 2.3ï¼ˆæ”¯å‡ºåˆ†ç±»è¿‡æ»¤ï¼‰å¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªæŒ‰ç±»å‹è¿‡æ»¤åˆ†ç±»çš„å±æ€§
- å±æ€§ 5.1-5.4ï¼ˆå„ç§æŸ¥è¯¢æ¡ä»¶ï¼‰éƒ½æ˜¯æŸ¥è¯¢è¿‡æ»¤çš„ä¸åŒç»´åº¦ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªç»¼åˆçš„æŸ¥è¯¢æ­£ç¡®æ€§å±æ€§è¦†ç›–

**ä¿ç•™çš„ç‹¬ç‰¹å±æ€§ï¼š**
- æ•°æ®æŒä¹…åŒ–å¾€è¿”å±æ€§ï¼ˆ11.1, 11.2ï¼‰
- åˆ é™¤æ“ä½œçš„æ­£ç¡®æ€§ï¼ˆ1.3ï¼‰
- è¾“å…¥éªŒè¯ï¼ˆ1.4ï¼‰
- æ’åºæ­£ç¡®æ€§ï¼ˆ3.5ï¼‰
- å æ¯”è®¡ç®—æ­£ç¡®æ€§ï¼ˆ4.5ï¼‰
- æˆå°±è§£é”é€»è¾‘ï¼ˆ8.1, 8.2, 8.3ï¼‰
- æƒ…ç»ªå…³è”å’Œè¿‡æ»¤ï¼ˆ7.2, 7.4, 7.5ï¼‰

### æ ¸å¿ƒå±æ€§

**å±æ€§ 1: äº¤æ˜“æŒä¹…åŒ–å¾€è¿”ä¸€è‡´æ€§**
*å¯¹äºä»»ä½•*æœ‰æ•ˆçš„äº¤æ˜“æ•°æ®ï¼Œåˆ›å»ºå¹¶ä¿å­˜åå†ä»å­˜å‚¨ä¸­åŠ è½½ï¼Œåº”è¯¥å¾—åˆ°ç­‰ä»·çš„äº¤æ˜“è®°å½•ï¼ˆé™¤äº†ç³»ç»Ÿç”Ÿæˆçš„IDå’Œæ—¶é—´æˆ³ï¼‰
**éªŒè¯éœ€æ±‚ï¼š11.1, 11.2**

**å±æ€§ 2: åˆ é™¤æ“ä½œçš„å®Œæ•´æ€§**
*å¯¹äºä»»ä½•*å­˜åœ¨çš„äº¤æ˜“è®°å½•ï¼Œæ‰§è¡Œåˆ é™¤æ“ä½œåï¼Œè¯¥è®°å½•ä¸åº”è¯¥å‡ºç°åœ¨ä»»ä½•æŸ¥è¯¢ç»“æœä¸­ï¼Œä¸”ç›¸å…³æ±‡æ€»æ•°æ®åº”è¯¥æ›´æ–°
**éªŒè¯éœ€æ±‚ï¼š1.3, 1.5**

**å±æ€§ 3: è¾“å…¥éªŒè¯çš„ä¸¥æ ¼æ€§**
*å¯¹äºä»»ä½•*æ— æ•ˆçš„äº¤æ˜“è¾“å…¥ï¼ˆè´Ÿæ•°é‡‘é¢ã€é›¶é‡‘é¢ã€æ— æ•ˆæ—¥æœŸæ ¼å¼ï¼‰ï¼Œç³»ç»Ÿåº”è¯¥æ‹’ç»åˆ›å»ºäº¤æ˜“è®°å½•
**éªŒè¯éœ€æ±‚ï¼š1.4**

**å±æ€§ 4: æ—¥æœŸèŒƒå›´æŸ¥è¯¢çš„å‡†ç¡®æ€§**
*å¯¹äºä»»ä½•*æ—¥æœŸèŒƒå›´æŸ¥è¯¢ï¼Œè¿”å›çš„æ‰€æœ‰äº¤æ˜“è®°å½•çš„æ—¥æœŸéƒ½åº”è¯¥åœ¨æŒ‡å®šèŒƒå›´å†…ï¼ˆåŒ…å«è¾¹ç•Œï¼‰
**éªŒè¯éœ€æ±‚ï¼š3.1, 3.3, 5.3**

**å±æ€§ 5: æ±‡æ€»è®¡ç®—çš„æ­£ç¡®æ€§**
*å¯¹äºä»»ä½•*æ—¶é—´æ®µï¼ˆæ—¥/å‘¨/æœˆ/å¹´ï¼‰çš„äº¤æ˜“é›†åˆï¼Œæ±‡æ€»çš„æ”¶å…¥æ€»é¢åº”è¯¥ç­‰äºæ‰€æœ‰æ”¶å…¥äº¤æ˜“çš„é‡‘é¢ä¹‹å’Œï¼Œæ”¯å‡ºæ€»é¢åº”è¯¥ç­‰äºæ‰€æœ‰æ”¯å‡ºäº¤æ˜“çš„é‡‘é¢ä¹‹å’Œï¼Œå‡€æ”¶æ”¯åº”è¯¥ç­‰äºæ”¶å…¥å‡å»æ”¯å‡º
**éªŒè¯éœ€æ±‚ï¼š3.2, 3.4, 4.1, 4.2, 4.3**

**å±æ€§ 6: æ—¶é—´å€’åºæ’åˆ—çš„ä¸€è‡´æ€§**
*å¯¹äºä»»ä½•*äº¤æ˜“è®°å½•åˆ—è¡¨ï¼Œæ’åºåçš„åˆ—è¡¨åº”è¯¥æ»¡è¶³ï¼šå¯¹äºä»»æ„ç›¸é‚»çš„ä¸¤æ¡è®°å½•ï¼Œå‰ä¸€æ¡çš„æ—¥æœŸåº”è¯¥å¤§äºæˆ–ç­‰äºåä¸€æ¡çš„æ—¥æœŸ
**éªŒè¯éœ€æ±‚ï¼š3.5**

**å±æ€§ 7: åˆ†ç±»å æ¯”è®¡ç®—çš„å®Œæ•´æ€§**
*å¯¹äºä»»ä½•*æ—¶é—´æ®µçš„æ±‡æ€»æ•°æ®ï¼Œæ‰€æœ‰åˆ†ç±»çš„å æ¯”ä¹‹å’Œåº”è¯¥ç­‰äº100%ï¼ˆè¯¯å·®åœ¨0.01%ä»¥å†…ï¼‰
**éªŒè¯éœ€æ±‚ï¼š4.5**

**å±æ€§ 8: åˆ†ç±»è¿‡æ»¤çš„ç±»å‹ä¸€è‡´æ€§**
*å¯¹äºä»»ä½•*äº¤æ˜“ç±»å‹ï¼ˆæ”¶å…¥/æ”¯å‡ºï¼‰ï¼Œè·å–çš„åˆ†ç±»åˆ—è¡¨ä¸­æ‰€æœ‰åˆ†ç±»çš„ç±»å‹éƒ½åº”è¯¥ä¸è¯·æ±‚çš„ç±»å‹åŒ¹é…
**éªŒè¯éœ€æ±‚ï¼š2.2, 2.3**

**å±æ€§ 9: åˆ†ç±»æ±‡æ€»çš„å‡†ç¡®æ€§**
*å¯¹äºä»»ä½•*äº¤æ˜“é›†åˆï¼ŒæŒ‰åˆ†ç±»æ±‡æ€»åï¼Œæ¯ä¸ªåˆ†ç±»çš„é‡‘é¢åº”è¯¥ç­‰äºè¯¥åˆ†ç±»ä¸‹æ‰€æœ‰äº¤æ˜“é‡‘é¢ä¹‹å’Œ
**éªŒè¯éœ€æ±‚ï¼š2.4**

**å±æ€§ 10: é‡‘é¢èŒƒå›´æŸ¥è¯¢çš„è¾¹ç•Œæ­£ç¡®æ€§**
*å¯¹äºä»»ä½•*é‡‘é¢èŒƒå›´æŸ¥è¯¢ï¼ˆæœ€å°å€¼ã€æœ€å¤§å€¼ï¼‰ï¼Œè¿”å›çš„æ‰€æœ‰äº¤æ˜“é‡‘é¢éƒ½åº”è¯¥åœ¨æŒ‡å®šèŒƒå›´å†…ï¼ˆåŒ…å«è¾¹ç•Œï¼‰
**éªŒè¯éœ€æ±‚ï¼š5.1**

**å±æ€§ 11: å…³é”®è¯æœç´¢çš„åŒ…å«æ€§**
*å¯¹äºä»»ä½•*ç”¨é€”å…³é”®è¯æœç´¢ï¼Œè¿”å›çš„æ‰€æœ‰äº¤æ˜“çš„æè¿°å­—æ®µéƒ½åº”è¯¥åŒ…å«è¯¥å…³é”®è¯ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
**éªŒè¯éœ€æ±‚ï¼š5.2**

**å±æ€§ 12: åˆ†ç±»è¿‡æ»¤çš„ç²¾ç¡®æ€§**
*å¯¹äºä»»ä½•*æŒ‡å®šçš„åˆ†ç±»ï¼ŒæŸ¥è¯¢è¿”å›çš„æ‰€æœ‰äº¤æ˜“éƒ½åº”è¯¥å±äºè¯¥åˆ†ç±»
**éªŒè¯éœ€æ±‚ï¼š5.4**

**å±æ€§ 13: å¤åˆæŸ¥è¯¢çš„äº¤é›†æ­£ç¡®æ€§**
*å¯¹äºä»»ä½•*å¤šä¸ªæŸ¥è¯¢æ¡ä»¶çš„ç»„åˆï¼Œè¿”å›çš„äº¤æ˜“è®°å½•åº”è¯¥åŒæ—¶æ»¡è¶³æ‰€æœ‰æŒ‡å®šçš„æ¡ä»¶
**éªŒè¯éœ€æ±‚ï¼š5.5**

**å±æ€§ 14: æƒ…ç»ªæ ‡ç­¾å…³è”çš„æŒä¹…æ€§**
*å¯¹äºä»»ä½•*å¸¦æœ‰æƒ…ç»ªæ ‡ç­¾çš„äº¤æ˜“ï¼Œä¿å­˜åå†æŸ¥è¯¢ï¼Œæƒ…ç»ªæ ‡ç­¾åº”è¯¥ä¿æŒä¸€è‡´
**éªŒè¯éœ€æ±‚ï¼š7.2**

**å±æ€§ 15: æƒ…ç»ªè¿‡æ»¤çš„å‡†ç¡®æ€§**
*å¯¹äºä»»ä½•*æŒ‡å®šæ—¥æœŸçš„æƒ…ç»ªäº¤æ˜“æŸ¥è¯¢ï¼Œè¿”å›çš„æ‰€æœ‰äº¤æ˜“éƒ½åº”è¯¥æ˜¯è¯¥æ—¥æœŸä¸”åŒ…å«æƒ…ç»ªæ ‡ç­¾çš„è®°å½•
**éªŒè¯éœ€æ±‚ï¼š7.5**

**å±æ€§ 16: è¿ç»­è®°è´¦æˆå°±çš„è§£é”æ¡ä»¶**
*å¯¹äºä»»ä½•*ç”¨æˆ·çš„äº¤æ˜“å†å²ï¼Œå¦‚æœå­˜åœ¨è¿ç»­7å¤©éƒ½æœ‰äº¤æ˜“è®°å½•ï¼Œåˆ™"è¿ç»­è®°è´¦7å¤©"æˆå°±åº”è¯¥è¢«è§£é”
**éªŒè¯éœ€æ±‚ï¼š8.1**

**å±æ€§ 17: é¢„ç®—æ§åˆ¶æˆå°±çš„è§£é”æ¡ä»¶**
*å¯¹äºä»»ä½•*æœˆä»½ï¼Œå¦‚æœè¯¥æœˆçš„æ€»æ”¯å‡ºå°äºæˆ–ç­‰äºé¢„è®¾é¢„ç®—ï¼Œåˆ™"æœˆåº¦é¢„ç®—æ§åˆ¶è¾¾äºº"æˆå°±åº”è¯¥è¢«è§£é”
**éªŒè¯éœ€æ±‚ï¼š8.2**

**å±æ€§ 18: é¤é¥®æ¶ˆè´¹æˆå°±çš„è§£é”æ¡ä»¶**
*å¯¹äºä»»ä½•*æ—¶é—´æ®µï¼Œå¦‚æœé¤é¥®åˆ†ç±»çš„æ”¯å‡ºå æ€»æ”¯å‡ºçš„æ¯”ä¾‹ä½äºè®¾å®šé˜ˆå€¼ï¼ˆå¦‚30%ï¼‰ï¼Œåˆ™"é¤é¥®æ¶ˆè´¹åˆç†åŒ–"æˆå°±åº”è¯¥è¢«è§£é”
**éªŒè¯éœ€æ±‚ï¼š8.3**

**å±æ€§ 19: æ•°æ®è¿ç§»çš„å‘åå…¼å®¹æ€§**
*å¯¹äºä»»ä½•*æ—§ç‰ˆæœ¬çš„æ•°æ®ç»“æ„ï¼Œæ‰§è¡Œè¿ç§»åï¼Œæ‰€æœ‰åŸæœ‰çš„äº¤æ˜“è®°å½•éƒ½åº”è¯¥èƒ½è¢«æ­£ç¡®è¯»å–ä¸”æ•°æ®å®Œæ•´
**éªŒè¯éœ€æ±‚ï¼š11.5**

## é”™è¯¯å¤„ç†

### é”™è¯¯ç±»å‹

1. **è¾“å…¥éªŒè¯é”™è¯¯**
   - é‡‘é¢ä¸ºè´Ÿæ•°æˆ–é›¶
   - æ—¥æœŸæ ¼å¼æ— æ•ˆ
   - å¿…å¡«å­—æ®µç¼ºå¤±
   - å¤„ç†ï¼šæ˜¾ç¤ºå…·ä½“çš„é”™è¯¯æç¤ºï¼Œä¿ç•™ç”¨æˆ·è¾“å…¥

2. **æ•°æ®åº“æ“ä½œé”™è¯¯**
   - è¿æ¥å¤±è´¥
   - å†™å…¥å¤±è´¥
   - è¯»å–å¤±è´¥
   - å¤„ç†ï¼šæ˜¾ç¤ºå‹å¥½çš„é”™è¯¯ä¿¡æ¯ï¼Œæä¾›é‡è¯•é€‰é¡¹ï¼Œè®°å½•é”™è¯¯æ—¥å¿—

3. **æ•°æ®ä¸ä¸€è‡´é”™è¯¯**
   - å¼•ç”¨çš„åˆ†ç±»ä¸å­˜åœ¨
   - äº¤æ˜“è®°å½•æŸå
   - å¤„ç†ï¼šå°è¯•è‡ªåŠ¨ä¿®å¤ï¼Œæ— æ³•ä¿®å¤æ—¶æç¤ºç”¨æˆ·

4. **ç½‘ç»œé”™è¯¯**ï¼ˆå¦‚æœæœ‰äº‘åŒæ­¥åŠŸèƒ½ï¼‰
   - è¿æ¥è¶…æ—¶
   - åŒæ­¥å¤±è´¥
   - å¤„ç†ï¼šä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œåå°é‡è¯•

### é”™è¯¯æ¢å¤ç­–ç•¥

- **äº‹åŠ¡æ€§æ“ä½œ**ï¼šä½¿ç”¨æ•°æ®åº“äº‹åŠ¡ç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- **æ•°æ®å¤‡ä»½**ï¼šå®šæœŸè‡ªåŠ¨å¤‡ä»½ç”¨æˆ·æ•°æ®
- **é™çº§å¤„ç†**ï¼šå…³é”®åŠŸèƒ½å¤±è´¥æ—¶æä¾›åŸºç¡€åŠŸèƒ½
- **ç”¨æˆ·åé¦ˆ**ï¼šæ‰€æœ‰é”™è¯¯éƒ½åº”è¯¥æœ‰æ¸…æ™°çš„ç”¨æˆ·æç¤º

## æµ‹è¯•ç­–ç•¥

### åŒé‡æµ‹è¯•æ–¹æ³•

æœ¬é¡¹ç›®é‡‡ç”¨å•å…ƒæµ‹è¯•å’ŒåŸºäºå±æ€§çš„æµ‹è¯•ç›¸ç»“åˆçš„æ–¹æ³•ï¼š

- **å•å…ƒæµ‹è¯•**ï¼šéªŒè¯ç‰¹å®šç¤ºä¾‹ã€è¾¹ç¼˜æƒ…å†µå’Œé”™è¯¯æ¡ä»¶
- **åŸºäºå±æ€§çš„æµ‹è¯•**ï¼šéªŒè¯åº”è¯¥åœ¨æ‰€æœ‰è¾“å…¥ä¸­ä¿æŒçš„é€šç”¨å±æ€§
- ä¸¤è€…äº’è¡¥ï¼šå•å…ƒæµ‹è¯•æ•è·å…·ä½“çš„bugï¼ŒåŸºäºå±æ€§çš„æµ‹è¯•éªŒè¯é€šç”¨æ­£ç¡®æ€§

### å•å…ƒæµ‹è¯•

**æµ‹è¯•èŒƒå›´ï¼š**
- æ•°æ®æ¨¡å‹çš„åˆ›å»ºå’ŒéªŒè¯
- Repositoryçš„CRUDæ“ä½œ
- Serviceå±‚çš„ä¸šåŠ¡é€»è¾‘
- UIç»„ä»¶çš„æ¸²æŸ“å’Œäº¤äº’
- è¾¹ç¼˜æƒ…å†µï¼ˆç©ºåˆ—è¡¨ã€è¾¹ç•Œå€¼ã€ç‰¹æ®Šå­—ç¬¦ï¼‰

**æµ‹è¯•å·¥å…·ï¼š**
- HarmonyOSæµ‹è¯•æ¡†æ¶ï¼ˆ@ohos/hypiumï¼‰
- Mockå·¥å…·ï¼ˆ@ohos/hamockï¼‰

**ç¤ºä¾‹æµ‹è¯•åœºæ™¯ï¼š**
- åˆ›å»ºäº¤æ˜“æ—¶æ‰€æœ‰å­—æ®µéƒ½æ­£ç¡®ä¿å­˜
- åˆ é™¤ä¸å­˜åœ¨çš„äº¤æ˜“è¿”å›é€‚å½“é”™è¯¯
- ç©ºäº¤æ˜“åˆ—è¡¨æ˜¾ç¤ºç©ºçŠ¶æ€UI
- æ—¥æœŸè¾¹ç•Œæƒ…å†µï¼ˆæœˆåˆã€æœˆæœ«ã€é—°å¹´ï¼‰

### åŸºäºå±æ€§çš„æµ‹è¯•

**æµ‹è¯•åº“ï¼š** ä½¿ç”¨fast-checkï¼ˆTypeScriptçš„å±æ€§æµ‹è¯•åº“ï¼‰æˆ–è‡ªå®šä¹‰å®ç°

**é…ç½®ï¼š** æ¯ä¸ªå±æ€§æµ‹è¯•è‡³å°‘è¿è¡Œ100æ¬¡è¿­ä»£

**æ ‡æ³¨æ ¼å¼ï¼š** æ¯ä¸ªå±æ€§æµ‹è¯•å¿…é¡»ä½¿ç”¨æ³¨é‡Šæ ‡æ³¨å¯¹åº”çš„è®¾è®¡æ–‡æ¡£å±æ€§
```typescript
// **Feature: expense-tracker, Property 1: äº¤æ˜“æŒä¹…åŒ–å¾€è¿”ä¸€è‡´æ€§**
```

**æµ‹è¯•ç­–ç•¥ï¼š**

1. **æ•°æ®ç”Ÿæˆå™¨**
   - éšæœºäº¤æ˜“ç”Ÿæˆå™¨ï¼ˆæœ‰æ•ˆå’Œæ— æ•ˆæ•°æ®ï¼‰
   - éšæœºæ—¥æœŸèŒƒå›´ç”Ÿæˆå™¨
   - éšæœºæŸ¥è¯¢æ¡ä»¶ç”Ÿæˆå™¨
   - éšæœºåˆ†ç±»ç”Ÿæˆå™¨

2. **å±æ€§æµ‹è¯•è¦†ç›–**
   - æ¯ä¸ªæ­£ç¡®æ€§å±æ€§å¯¹åº”ä¸€ä¸ªå±æ€§æµ‹è¯•
   - æµ‹è¯•åº”è¯¥è¦†ç›–å„ç§è¾“å…¥ç»„åˆ
   - ä½¿ç”¨æ”¶ç¼©ï¼ˆshrinkingï¼‰æ‰¾åˆ°æœ€å°å¤±è´¥æ¡ˆä¾‹

3. **æµ‹è¯•ç¤ºä¾‹**

```typescript
// **Feature: expense-tracker, Property 1: äº¤æ˜“æŒä¹…åŒ–å¾€è¿”ä¸€è‡´æ€§**
test('property: transaction persistence round-trip', async () => {
  await fc.assert(
    fc.asyncProperty(
      transactionArbitrary(), // éšæœºäº¤æ˜“ç”Ÿæˆå™¨
      async (transaction) => {
        const saved = await repository.create(transaction);
        const loaded = await repository.getById(saved.id);
        
        // éªŒè¯å¾€è¿”ä¸€è‡´æ€§ï¼ˆå¿½ç•¥ç³»ç»Ÿç”Ÿæˆå­—æ®µï¼‰
        expect(loaded.amount).toBe(transaction.amount);
        expect(loaded.category).toBe(transaction.category);
        expect(loaded.description).toBe(transaction.description);
        // ... å…¶ä»–å­—æ®µ
      }
    ),
    { numRuns: 100 }
  );
});

// **Feature: expense-tracker, Property 5: æ±‡æ€»è®¡ç®—çš„æ­£ç¡®æ€§**
test('property: summary calculation correctness', async () => {
  await fc.assert(
    fc.asyncProperty(
      fc.array(transactionArbitrary()), // éšæœºäº¤æ˜“æ•°ç»„
      periodArbitrary(), // éšæœºæ—¶é—´æ®µ
      async (transactions, period) => {
        // ä¿å­˜æ‰€æœ‰äº¤æ˜“
        for (const t of transactions) {
          await repository.create(t);
        }
        
        const summary = await service.getSummary(period);
        
        // æ‰‹åŠ¨è®¡ç®—æœŸæœ›å€¼
        const expectedIncome = transactions
          .filter(t => t.type === 'income' && isInPeriod(t.date, period))
          .reduce((sum, t) => sum + t.amount, 0);
        
        const expectedExpense = transactions
          .filter(t => t.type === 'expense' && isInPeriod(t.date, period))
          .reduce((sum, t) => sum + t.amount, 0);
        
        // éªŒè¯æ±‡æ€»æ­£ç¡®æ€§
        expect(summary.totalIncome).toBeCloseTo(expectedIncome, 2);
        expect(summary.totalExpense).toBeCloseTo(expectedExpense, 2);
        expect(summary.netAmount).toBeCloseTo(expectedIncome - expectedExpense, 2);
      }
    ),
    { numRuns: 100 }
  );
});
```

### é›†æˆæµ‹è¯•

- æµ‹è¯•å®Œæ•´çš„ç”¨æˆ·æµç¨‹ï¼ˆæ·»åŠ äº¤æ˜“ â†’ æŸ¥çœ‹åˆ—è¡¨ â†’ æŸ¥è¯¢ â†’ åˆ é™¤ï¼‰
- æµ‹è¯•æ•°æ®åº“è¿ç§»åœºæ™¯
- æµ‹è¯•ä¸åŒå±å¹•å°ºå¯¸çš„å“åº”å¼å¸ƒå±€

### UIæµ‹è¯•

- ç»„ä»¶æ¸²æŸ“æµ‹è¯•
- ç”¨æˆ·äº¤äº’æµ‹è¯•ï¼ˆç‚¹å‡»ã€æ»‘åŠ¨ã€è¾“å…¥ï¼‰
- å“åº”å¼å¸ƒå±€æµ‹è¯•
- æ— éšœç¢æ€§æµ‹è¯•

## æ€§èƒ½è€ƒè™‘

### ä¼˜åŒ–ç­–ç•¥

1. **æ•°æ®åº“ä¼˜åŒ–**
   - ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µï¼ˆdate, category, typeï¼‰åˆ›å»ºç´¢å¼•
   - ä½¿ç”¨æ‰¹é‡æ“ä½œå‡å°‘æ•°æ®åº“è®¿é—®æ¬¡æ•°
   - å®ç°åˆ†é¡µåŠ è½½å¤§é‡äº¤æ˜“è®°å½•

2. **UIæ€§èƒ½**
   - ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨å¤„ç†é•¿åˆ—è¡¨
   - å›¾è¡¨æ•°æ®é‡‡æ ·ï¼ˆå¤§æ•°æ®é›†æ—¶ï¼‰
   - æ‡’åŠ è½½éå…³é”®ç»„ä»¶
   - ä½¿ç”¨@Stateä¼˜åŒ–çŠ¶æ€æ›´æ–°

3. **è®¡ç®—ä¼˜åŒ–**
   - ç¼“å­˜æ±‡æ€»è®¡ç®—ç»“æœ
   - å¢é‡æ›´æ–°ç»Ÿè®¡æ•°æ®
   - ä½¿ç”¨Web Workerå¤„ç†å¤æ‚è®¡ç®—ï¼ˆå¦‚æœæ”¯æŒï¼‰

### æ€§èƒ½ç›®æ ‡

- åº”ç”¨å¯åŠ¨æ—¶é—´ï¼š< 2ç§’
- äº¤æ˜“åˆ—è¡¨åŠ è½½ï¼š< 500msï¼ˆ100æ¡è®°å½•ï¼‰
- æ±‡æ€»è®¡ç®—ï¼š< 500ms
- UIäº¤äº’å“åº”ï¼š< 100ms
- æ•°æ®åº“æ“ä½œï¼š< 200ms

## å®‰å…¨æ€§

### æ•°æ®å®‰å…¨

- æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨è®¾å¤‡æœ¬åœ°
- ä½¿ç”¨HarmonyOSçš„å®‰å…¨å­˜å‚¨API
- æ•æ„Ÿæ•°æ®ï¼ˆå¦‚æœæœ‰ï¼‰ä½¿ç”¨åŠ å¯†å­˜å‚¨

### è¾“å…¥å®‰å…¨

- æ‰€æœ‰ç”¨æˆ·è¾“å…¥è¿›è¡ŒéªŒè¯å’Œæ¸…ç†
- é˜²æ­¢SQLæ³¨å…¥ï¼ˆä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼‰
- é™åˆ¶è¾“å…¥é•¿åº¦é˜²æ­¢æº¢å‡º

## å¯è®¿é—®æ€§

- æ”¯æŒå±å¹•é˜…è¯»å™¨
- æä¾›è¶³å¤Ÿçš„é¢œè‰²å¯¹æ¯”åº¦
- å¯è§¦æ‘¸ç›®æ ‡è‡³å°‘48dp
- æ”¯æŒå­—ä½“ç¼©æ”¾
- æä¾›æ›¿ä»£æ–‡æœ¬

## å›½é™…åŒ–

- æ”¯æŒå¤šè¯­è¨€ï¼ˆä¸­æ–‡ã€è‹±æ–‡ï¼‰
- è´§å¸æ ¼å¼æœ¬åœ°åŒ–
- æ—¥æœŸæ ¼å¼æœ¬åœ°åŒ–
- æ•°å­—æ ¼å¼æœ¬åœ°åŒ–

## æœªæ¥æ‰©å±•

### å¯èƒ½çš„åŠŸèƒ½

- äº‘åŒæ­¥å’Œå¤‡ä»½
- é¢„ç®—ç®¡ç†å’Œæé†’
- è´¦å•æ‰«æå’ŒOCRè¯†åˆ«
- å¤šè´¦æˆ·æ”¯æŒ
- æ•°æ®å¯¼å‡ºï¼ˆCSV, Excelï¼‰
- æ›´å¤šå›¾è¡¨ç±»å‹
- è‡ªå®šä¹‰åˆ†ç±»
- å®šæœŸäº¤æ˜“æ¨¡æ¿
- è´¢åŠ¡æŠ¥å‘Šç”Ÿæˆ

### æ¶æ„æ‰©å±•æ€§

- æ¨¡å—åŒ–è®¾è®¡ä¾¿äºæ·»åŠ æ–°åŠŸèƒ½
- ä½¿ç”¨æ¥å£æŠ½è±¡ä¾¿äºæ›¿æ¢å®ç°
- æ’ä»¶åŒ–çš„æˆå°±ç³»ç»Ÿ
- å¯é…ç½®çš„å›¾è¡¨å¼•æ“
