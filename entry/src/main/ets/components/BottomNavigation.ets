import router from '@ohos.router';

/**
 * BottomNavigation - åº•éƒ¨å¯¼èˆªæ ç»„ä»¶
 * æä¾›ä¸»è¦é¡µé¢é—´çš„å¿«é€Ÿå¯¼èˆª
 * éœ€æ±‚ï¼š9.1, 9.2, 9.3
 */

export interface NavigationItem {
  icon: string;
  label: string;
  url: string;
  active: boolean;
}

@Component
export struct BottomNavigation {
  @Prop currentPage: string = 'Index'; // Current active page name
  
  /**
   * Get navigation items
   * éœ€æ±‚ï¼š12.1 - åœ¨å¯¼èˆªæ æ·»åŠ é¢„ç®—ç®¡ç†å…¥å£
   * éœ€æ±‚ï¼š13.1 - åœ¨è®¾ç½®æˆ–æ›´å¤šé¡µé¢æ·»åŠ æ•°æ®å¯¼å‡ºå…¥å£
   */
  private getNavigationItems(): NavigationItem[] {
    return [
      {
        icon: 'ðŸ ',
        label: 'é¦–é¡µ',
        url: 'pages/Index',
        active: this.currentPage === 'Index'
      },
      {
        icon: 'ðŸ“Š',
        label: 'ç»Ÿè®¡',
        url: 'pages/StatisticsPage',
        active: this.currentPage === 'StatisticsPage'
      },
      {
        icon: 'ðŸ’°',
        label: 'é¢„ç®—',
        url: 'pages/BudgetPage',
        active: this.currentPage === 'BudgetPage'
      },
      {
        icon: 'ðŸ”',
        label: 'æŸ¥è¯¢',
        url: 'pages/QueryPage',
        active: this.currentPage === 'QueryPage'
      },
      {
        icon: 'â‹¯',
        label: 'æ›´å¤š',
        url: 'pages/MorePage',
        active: this.currentPage === 'MorePage'
      }
    ];
  }

  /**
   * Navigate to page
   */
  private navigateToPage(url: string) {
    // Use replaceUrl to avoid stacking navigation pages
    router.replaceUrl({
      url: url
    }).catch((error: Error) => {
      console.error(`Failed to navigate to ${url}:`, error);
    });
  }

  /**
   * Build UI
   */
  build() {
    Row() {
      ForEach(this.getNavigationItems(), (item: NavigationItem) => {
        Column() {
          Text(item.icon)
            .fontSize(24)
            .margin({ bottom: 4 })
          
          Text(item.label)
            .fontSize(12)
            .fontColor(item.active ? '#1890FF' : '#666666')
            .fontWeight(item.active ? FontWeight.Medium : FontWeight.Normal)
        }
        .layoutWeight(1)
        .height('100%')
        .justifyContent(FlexAlign.Center)
        .backgroundColor(item.active ? '#E6F7FF' : Color.Transparent)
        .onClick(() => {
          if (!item.active) {
            this.navigateToPage(item.url);
          }
        })
      }, (item: NavigationItem) => item.url)
    }
    .width('100%')
    .height(56)
    .backgroundColor(Color.White)
    .shadow({
      radius: 8,
      color: '#00000010',
      offsetX: 0,
      offsetY: -2
    })
  }
}
